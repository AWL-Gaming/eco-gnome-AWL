
<MudDialog>
    <TitleContent>
        Create or join a server
    </TitleContent>
    <DialogContent>
        <MudPaper Elevation="0" Class="pa-2" Style="align-items: center; justify-content: space-between; gap: 16px;">
            <MudText Typo="Typo.subtitle1">Do you already have an invitation?</MudText>
            <MudTextField @bind-Value="JoinCode"
                          Class="mt-0"
                          Immediate="true"
                          Label="Join code"
                          Variant="Variant.Outlined"
                          Adornment="Adornment.End"
                          AdornmentIcon="@Icons.Material.Filled.Done"
                          AdornmentAriaLabel="join server"
                          AdornmentColor="Color.Tertiary"
                          OnAdornmentClick="OnJoinServer"
                          OnKeyDown="OnKeyDownJoinAsync" />
        </MudPaper>

        <MudDivider DividerType="DividerType.FullWidth" Class="my-6" />

        <MudPaper Elevation="0" Class="pa-2" Style="align-items: center; justify-content: space-between; gap: 16px;">
            <MudText Typo="Typo.subtitle1">Create your server</MudText>        
            <MudTextField @bind-Value="ServerName" 
                          Immediate="true" 
                          Variant="Variant.Outlined"
                          Label="Your server name" 
                          Adornment="Adornment.End"
                          AdornmentIcon="@Icons.Material.Filled.Done"
                          AdornmentAriaLabel="join server"
                          AdornmentColor="Color.Tertiary" 
                          OnAdornmentClick="OnCreateServer"
                          OnKeyDown="OnKeyDownCreateAsync"/>
        </MudPaper>        
    </DialogContent>

    <DialogActions>
        <MudButton OnClick="Cancel" Color="Color.Secondary">Annuler</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; } = default!;

    public string ServerName { get; set; }

    public string JoinCode { get; set; }

    private void Cancel()
    {
        MudDialog.Cancel();
    }

    private async Task OnKeyDownCreateAsync(KeyboardEventArgs args)
    {
        switch (args.Key)
        {
            case "Enter":
            case "NumpadEnter":
                OnCreateServer();
                break;
        }
    }

    private async Task OnKeyDownJoinAsync(KeyboardEventArgs args)
    {
        switch (args.Key)
        {
            case "Enter":
            case "NumpadEnter":
                OnJoinServer();
                break;
        }
    }

    private void OnCreateServer()
    {
        MudDialog.Close(DialogResult.Ok(new[] { "Create", ServerName }));
    }

    private void OnJoinServer()
    {
        MudDialog.Close(DialogResult.Ok(new[] { "Join", JoinCode }));
    }
}
